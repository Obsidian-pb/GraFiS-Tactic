# Работа в версии 12

## v12.0.00
- [x] обеспечена корректная работа системы в 201х версиях MS Visio
- [x] в трафарет "Отчеты" добавлен инструмент проверки схем("Мастер проверок"), включающий:
	- [x] оценку схем на наличие наиболее характерных ошибок (отсутствие указания решающего направления, подписей рукавных линий и т.д.)
	- [x] оценку Оперативно-тактических параметров текущей схемы (количество техники, рукавов, личного состава, звеньев ГДЗС и т.д.)
- [x] исправлены значения гидравлических сопротивлений для рукавов больших диаметров и механика их получения из базы данных (ранее гидравлические сопротивления менее 0,0001 не возвращались).
- [x] исправлены даты в фигурах - ранее в 201х версиях не все фигуры позволяли указывать корректные значения дат и времени
- [x] в качестве модели автоцистерны по-умолчанию выбрана условная АЦ-40 среднего класса, за основу которой взята одна из самых распространенных моделей АЦ - АЦ-3,2-40/4(43253)001-МС насос выбран НЦПК 40/100-4/400. ТТХ: боевой расчет - 5, Рукава 51 – 10шт., Рукава 77 – 8шт, Запас воды: 3200л, пенообразователя – 200л.
- [x] исправлены значения гидравлических сопротивлений для рукавов больших диаметров и механика их получения из базы данных (ранее гидравлические сопротивления менее 0,0001 не возвращались)
- [x] исправлена ошибка при попытке сформировать массив помещений на листе без помещений
- [x] звенья ГДЗС теперь имеют свойство "Состояние" позволяющее указывать работает ли звено или находится в резерви, либо заправляет баллоны СИЗОД;
- [x] при размещении звеньев ГДЗС поверх рукавных линий первые автоматически переключаются в состояние "Работает", при размещении не поверх линий - "В резерве". При этом численнойсть личного состава работающего со стволом зависит от того работает с ними звено ГДЗС или нет. Если да, то 0, если ствол работает без звена, то согласно требованиям.
- [x] исправлено отображение времени в подсказаках звена ГДЗС
- [x] фигуры боевых участков при размещении автоматически получают новый номер.

## v12.1.00
- [x] Звенья ГДЗС теперь автоматически разворачиваются параллельно рукавным линиям
- [x] Фигуры рукавов в скатках и гармошках теперь корректно обрабатываются при анализе
- [x] Полностью переписана механика анализа схем 
	- [x] Окно мастера проверок разбито на два окна, размещающихся пристыкованными к нижнему краю экрана - Окно "Мастер проверок" отображающее ошибки и недочеты схемы; Окно "Мастер тактических данных". Окна могут быть перемещены в любое место рабочего окна приложения Visio или вложены друг в друга
	- [x] Добавлено окно Настройки расчета. В данный момент здесь имеется возможность выбирать каким образом будет округляться требуемое количество звеньев ГДЗС, исходя из требования формирования одного резервного звена на каждые три работающих - в большую или меньшую сторону
- [x] Добавлены новые позиции для расчета: (рукавов проложено, рукавов имеется, запас воды на 10минут, общий запас пенообразователя, кол-во БУ и СПР, и т.д.)
- [x] Сделано корректное отображение, свищей и мостиков при разных масштабах;
- [x] Исправлен ряд ошибок связанных с функционированием окон из трафарета Формы управления
	- [x] Исправлено отображение времени в столбцах форм
	- [x] Исправлена ошибка возникавшая при клике по пустому списку
	- [x] Добавлена обработка ряда новых фигур (АПП, Машины на гусеничном ходу, Танк)
	- [x] В установочный пакет добавлена библиотека MSCOMCTL.OCX отвечающая за работу форм управления
- [x] Сделана корректная фигура пожарного поезда - с патрубками и свойствами расхода
- [x] В базу данных добавлен новый набор техники - Распространенные. В этом наборе находятся только самые распространенные модели техники. В целом это не слишком актуально, но для автоцистерн и автолестниц позволяет выбирать изначально из небольшого списка наиболее распространенных моделей. Модели определены в соответствии с наиболее популярными страницами проекта wiki-fire.org
- [x] Сделана постоянная ориентация относительно горизонта для подписи сторон света
- [x] В фигуре строки экспликации убраны отступы для ячеек таблицы, что позволяет более аккуратно ее масштабировать
- [x] Добавлена возможность указывать дополнительные сведения о ИНППВ в формате html. Можно указывать произвольные данные, в том числе изображения
- [x] Фигура «Всасывающая линия» из трафарета ПТВ теперь при размещении автоматически определяет из какого водоема забирает воду, что позволяет учитывать ее при проведении анализа НРС
- [x] Фигура «Гидроэлеватор» из трафарета ПТВ работает также
- [x] Исправлена ошибка привязывания фигур звеньев ГДЗС к удаленным линиям
- [x] Исправлен расчет максимальной длины рукавных линий (ранее перепад высот считался в обратную сторону)
- [x] Добавлен расчет максимально возможного расстояния прокладки рукавных линий
- [x] Исправлена ошибка при которой в версии Visio 2019 не формировался массив помещений объекта ссылаясь на отсутствие трафарета "Структурные элементы", несмотря на то, что данный трафарет был подключен
- [x] На панель работы со временем (панель "Таймер" трафарета "Спецфункции") добавлена кнопка "Установить текущее время" позволяющая одним нажатием указать для выбранных фигур текущее время схемы
- [x] Для трафарета "Линии" добавлена функция "Обратить в проброс". Проброс - это указание рукавной линии проложенной между этажами при использовании варианта схем с расположением поэтажных планов один над другим. Проброс не имеет длины, но может использоваться для указания перепада высоты
- [x] В трафарет "Отчеты" добавлен новый тип отчета - радиальная диаграмма. Эта фигура позволяет наглядно представить все основные показатели условий локализации пожара: достаточность личного состава, звеньев ГДЗС, основных пожарных автомобилей, расхода и запаса воды и количества поданных стволов (приведенных к общему расходу)
- [x] Исправлены ошибки принадлежности некоторых фигур к слоям. Например, ранее при попытке скрыть слой "Техника" фигуры АЛ скрывались, а вот сами лестницы этих автомобилей оставались видимыми
- [x] Исправлены ошибки связанные с вылетанием Visio при попытке удалить подписи зон горения, водоемов или универсальные подписи трафарета "Прочее"
- [x] Для фигур рукавных линий добавлена возможность расчета максимально возможного расхода воды при заданных условиях
- [x] Исправлена механика работы подписей рукавов - раньше они некорректно отображались на вертикальных и горизонтальных линиях
- [x] Переработаны фигуры расстояний и добавлена возможность их автоматической расстановки

## v12.1.01
- [x] Исправлены подписи в радиальной диаграмме. Теперь они корректно отображаются во всех масштабах.
- [x] Исправлена толщина линий в фигуре АКП
- [x] Исправлена ошибка при попытке экспорта схем в изображения (трафарет "Спецфункции")
- [x] Исправлена ошибка в таблице интенсивностей подачи воды для Жилых домов I, II, III степеней огнестойкости. Ранее была 0,03 л/с/м.кв., что не соответствует справочным данным
- [x] Для графиков площади пожара и площади тушения добавлена опция "Время окончания не известно", позволяющая изображать график заканчивающимся прямой линией
- [x] Графики площади пожара и площади тушения теперь при расчете рассматривают зоны горения с одинаковым временем кок одну фигуру (данные о площади суммируются)
- [x] При вбрасывании поля совмещенного графика для определения максимального размера теперь учитывается не только площадь пожара, но и расход
- [X] При построении площади пожара методом компьютерного моделирования в подписи формы отображается фактическая площадь тушения пожара и требуемый расход воды

## v12.1.02
- [x] Исправлена ошибка размещения звеньев ГДЗС на рукавных линиях ведущих к пенным и лафетным стволам
- [x] Несколько изменена механика обработки ошибок в программном коде VBA
- [x] Исправлены значения запаса рукавов у некоторых моделей АР
- [x] При расчете формы площади пожара при помощи моделирвоания больше не появляется окно данных площади пожара. Все данные сохраняются сразу в фигуре
- [X] Добавлены подписи звена ГДЗС, указывающие на марку, тип дыхателных аппаратов, а также на состояние звена, находящегося в резерве
- [X] В мастер проверок возвращена оценка наличия КПП при трех работающих звеньях ГДЗС
- [X] Обновлена фигура Расстояние, теперь фигура способна привязываться к объектам, самостоятельно менять цвет, добавлено три вида отображения линии в отношении стрелок (однонаправленная, двунаправленная, однонаправленная сокращенная). Также добавлена функция Реверс для смены направления линии
- [X] В фигуры ИНППВ добавлена функция автоматической прокладки расстояния до очага, при вбрасывании или из контекстного меню
- [X] В фигуру Здание добавлена функция автоматической прокладки расстояний от соседних зданий и ИНППВ. Вызывается из контекстного меню. Пока стабильно работает только в Visio 2007!
- [X] Учет СПР добавлен в мастер тактических данных
- [X] Исправлен учет фигур Автомобиль общее обозначение, Приспособленная техника, Инж или спец машины в мастере тактических данных
- [X] В базу данных добавлены типовые АЛ-30 (выводится по-умолчанию) и АЛ-50 без уточнения модели, с боевым расчетом в 1 человека. Ранее аналогичным образом был добавлен типовой АГДЗС с боевым расчетом в 7 человек
- [X] В базу данных добавлен типовой ствол СВД без уточнения модели
  
  ## v12.2.00
- [X] Кардинально переработан механизм отрисовки фигур при расчете формы площади пожара методом моделирования в результате чего скорость пострения увеличилась в 2-3 раза (на крупных площадях эффект заметнее)
- [x] Исправлено отображение некоторых типов значений в универсальных подписях. Теперь для числовых значений можно указвать точность округления, а значения времени имеют формат "ЧЧ:ММ" (раньше показывались просто числом)
- [x] В перечень свойств фигур звеньев ГДЗС добавлено свойство "Время команды (с очагом)" отражающее время в которое постовому ПБ следует передавть команду на выход звена из НДС
- [x] Теперь имеется возможность проводить быстрый расчет параметров работы звена непосредственно в окне данных фигуры. Пользователь теперь может явным образом указывать значения свойств "Мин давление при включении", "Макс падение давления", "Мин давление у очага". Соответсвующие расчеты прочих параметров будут проводиться автоматически.
- [x] При проведении расчетов с использованием калькулятора ГДЗС свойства "Мин давление при включении", "Макс падение давления", "Мин давление у очага" теперь так же обновляются. При этом указанные пользователем значения заменяются на расчетные.
- [x] Исправлена ошибка расчета расхода воды в рукавных линиях ведущих к возимому лафетному стволу
- [x] Исправлены значения гидравлических сопротивлений для напорных рукавов диаметром 200, 250 и 300мм.
- [ ] Реализован инструмент расчета и построения площади тушения для произвольных форм зоны горения
- [ ] Реализован инструмент построения площади тушения в процессе моделирования площади пожара
- [x] Фигура расстояния теперь вычисляет и требуемую длину рукавных линий
- [x] Сделана спецфункция "Выбрать все фигуры данного типа", которая добавляет в выделение все фигуры ГраФиС аналогичные выбранным (можно несколько типов)
- [x] В трафарет "Отчеты" добавлен новый "Отчет по рукавам", позволяющий сравнить требуемое количество рукавов с имеющимся. Пользователь может настроить сведения по рукавам каких именно диаметров необходимо отразить в отчете
- [x] В режиме конструктора отчетов теперь можно скрыть текст вполях данных, что бывает крайне необходимо при составлении отчетов с полями небольшого размера (например в означенном выше отчете по рукавам)
- [x] Текст в полях отчетов теперь адаптивен к высоте фигур, но может быть модифицирован в соответсвии с назначением конкртеных отчетов. Соответсвующим образом переработаны имеющиеся отчеты
- [x] В окне тактических данных добавлена строка со сведениями о имеющихся рукавах
- [x] Добавлен учет длины напорных рукавов больших диаметров (для рукавов диаметром свыше 150мм она составляет 100м)
- [x] Экспорт данных из отчета Тактических данных в Word или txt
- [x] В отчет Тактических данных добавлены сведения о имеющихся рукавах
- [x] Устранена ошибка некорректного получения данных автомобилями при добавлении из связанной таблицы данных
- [ ] Для фигур расстояний теперь рассчитывается так же длина требуемой рукавной линии (даделать для расстояний от ПГ)
- [ ] Изменить название слоя для указателей расстояния
- [ ] Добавлена фигура Площадь защиты
- [ ] Стволы теперь могут подаваться так же и на проливку (не учитываются в анализе)
- [ ] При построении совмещенного графика учитываются только стволы поданные на тушение. 
- [ ] В мастер тактических данных добавлены показатели количества стволов поданых на защиту/проливку/проверку и т.д.


- [ ] Переработать формы управления без использования MSCOMCTL.OCX
- [ ] Сделать визуальное выделение автомобилей парамеры работы насосов которых превышают их тактические возможности
- [ ] Сделать форму учета использования личного состава (кто где и чем занят)
- [ ] Упорядочены фигуры в трафаретах (Особенно то что касается конструкций и плана местности)
- [ ] Разработать инструмент позволяющий формировать списки техники гарнизона 